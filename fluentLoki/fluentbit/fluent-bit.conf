[SERVICE]
    Flush        5
    Daemon       Off
    Log_Level    info
    Parsers_File parsers.conf

# ───────────────────────────────────────────────
# SYSLOG INPUT (via UDP, port 5140)
# ───────────────────────────────────────────────
[INPUT]
    Name        syslog
    Mode        udp
    Listen      0.0.0.0
    Port        5140
    Tag         logs.syslog
    Parser      syslog

[FILTER]
    Name        modify
    Match       logs.*
    Add         source_type   log
    Add         log_type      syslog
    Add         host          ${HOSTNAME}

# ───────────────────────────────────────────────
# CPU METRICS
# ───────────────────────────────────────────────
[INPUT]
    Name        cpu
    Tag         metrics.cpu

# ───────────────────────────────────────────────
# MEMORY METRICS
# ───────────────────────────────────────────────
[INPUT]
    Name        mem
    Tag         metrics.mem

# ───────────────────────────────────────────────
# DISK METRICS
# ───────────────────────────────────────────────
[INPUT]
    Name        disk
    Tag         metrics.disk

[FILTER]
    Name        modify
    Match       metrics.*
    Add         source_type   metric
    Add         metric_type   system
    Add         host          ${HOSTNAME}

# ───────────────────────────────────────────────
# OUTPUT: Loki
# ───────────────────────────────────────────────
[OUTPUT]
    Name        loki
    Match       *
    Host        loki
    Port        3100
    URI         /loki/api/v1/push
    Labels      job=fluentbit,source_type=$source_type,log_type=$log_type,metric_type=$metric_type,host=$host
    Line_Format json
